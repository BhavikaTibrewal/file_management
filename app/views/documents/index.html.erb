<h1>Documents</h1>
<div class="col-sm-3">
  <%= form_for(:document, url: document_path, method: 'post') do |f| %>
    <div class="custom-file add-new">
      <%= f.label :user_document, class:"custom-file-label" do %>Upload File
        <%= f.file_field :user_document, class: 'custom-file-input',
                         onchange: "this.form.submit();" %>
      <% end %>
    </div>
  <% end %>
</div>
<% if @documents.any? %>
  <table class="documents-table">
    <thead>
    <tr>
      <th>Name : </th>
      <th>Upload Date :</th>
      <th>Size :</th>
      <th>Actions :</th>
      <th>Sharing :</th>
    </tr>
    </thead>
    <tbody>
    <% @documents.each do |document| %>
      <% if document.user_document.attached? %>
        <tr>
          <td><%= document.user_document.filename %></td>
          <td><%= document.user_document.created_at.strftime("%-d %b %Y %H:%M") %></td>
          <td><%= file_size_verbose document.user_document.byte_size %></td>
          <td>
            <%= link_to 'Download', document.user_document, download: '' %> |&nbsp;
            <%= link_to "Delete", document_path(document.key),
                        data: {:confirm => 'Are you sure you want to delete?'},
                        method: :delete %>
          </td>
          <td>
            <div>
              <%= form_for(:document, url: document_path(document.key),
                           method: 'patch') do |f| %>
                <div class="custom-control custom-switch">
                  <input class="custom-control-input" type="checkbox"
                         onclick="this.form.submit();" value="1" <%= 'checked' if document.shared %>
                         name="document[shared]" id="share-<%= document.key %>"/>
                  <label class="custom-control-label"
                         for="share-<%= document.key %>"></label>
                </div>
              <% end %>
              <% if document.shared %>
                <%= link_to "Link", document_path(document.key), target: :_blank %>
              <% end %>
            </div>
          </td>
        </tr>
      <% end %>
    <% end %>
    </tbody>
  </table>
<% end %>